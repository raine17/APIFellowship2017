{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block javascript %}
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Refugees'],
          {% for object in city_by_year %}['{{ object.year }}',  {{ object.total }}],{% endfor %}
        ]);

        var options = {
          title: 'Refugees by year',
          curveType: 'function',
          legend: { position: 'bottom' },
          colors:['#FF8966', '#91C7B1', '#2E5266'],
          animation: {
            startup: true,
            duration: 1000,
            easing: 'out',
                      }
        };

        var chart = new google.visualization.LineChart(document.getElementById('chart'));

        chart.draw(data, options);
      }
    </script>
{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-2"></div>
  <div class="col-md-8">

    <h1>{{ city }}, {{ state }}</h1>

    <h3>{{ all_refugee_total.city_total__sum|intcomma }} have been resettled here since 2002.</h3>

    <div id="chart" style="width: 100%"></div>

    Top countries of origin

    <table class="table table-striped">
      <thead>
        <tr>
          <th>Country</th> <th>Total since 2002</th>
        </tr>
      </thead>
      <tbody>
        {% for object in country_totals %}
        <tr> <td><a href="{{ object.name_slug }}/">{{ object.name }}</a></td> <td>{{ object.total|intcomma }}</td> </tr>
        {% endfor %}
      </tbody>
    </table>

Data from the <a href="http://ireports.wrapsnet.org/" target=blank>Refugee Processing Center.</a> Last updated July 2017

<br></br>
<br></br>

</div>
  <div class="col-md-2"></div>
</div>

<div class="row">
  <div class="col-md-5"></div>
  <div class="col-md-2"><button type="button" class="btn btn-primary btn-lg btn-block"><a href="/resources_page">Getting started</a></button></div>
  <div class="col-md-5"></div>
</div>

<br></br>
<br></br>

</div>
  <div class="col-md-2"></div>
</div>
{% endblock %}
